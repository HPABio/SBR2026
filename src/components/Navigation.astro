---
import SBRFavicon from "@/assets/SBR2026-Favicon.png";

import BubbleButton from '@/components/ui/BubbleButton.astro';
// Navigation component for SynBio Reactor Summit
const currentPath = Astro.url.pathname;

const isActive = (path: string) => {
  if (path === '/') {
    return currentPath === '/';
  }
  return currentPath.startsWith(path);
};

const getLinkClasses = (path: string) => {
  return isActive(path)
    ? 'text-sm text-[#ff8800] font-medium'
    : 'text-sm text-muted-foreground hover:text-foreground transition-colors';
};
---

<nav class="fixed top-0 left-0 right-0 z-50 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/80 border-b border-border">
  <div class="container mx-auto px-4 lg:px-8">
    <div class="flex items-center justify-between h-16">
      <a href="/" class="flex items-center gap-2">
        <img 
          src={SBRFavicon.src} 
          alt="SynBio Reactor Logo" 
          class="w-10 h-10"
        />
        <span class="hidden lg:block font-bold text-2xl font-anton uppercase"> #SBR2026</span>
      </a>

      <div class="hidden md:flex items-center gap-6">
        <a href="/" class={getLinkClasses('/')}>
          Home
        </a>
        <a href="/timetable" class={getLinkClasses('/timetable')}>
          Time Table
        </a>
        <a href="/pitchPerfect" class={getLinkClasses('/pitchPerfect')}>
          Pitching
        </a>
        <a href="/about" class={`${getLinkClasses('/about')} hidden`}>
          About
        </a>
        <a href="https://gasb.de" class={`${getLinkClasses('/gasb')} hidden lg:block`}>
          GASB
        </a>
        <a
          href="/partners"
          class={getLinkClasses('/partners')}
        >
          Partners
        </a>
        <a href="/sponsoring" class={`${getLinkClasses('/sponsoring')} hidden lg:block`}>
          Sponsoring
        </a>
      </div>

      <!-- <button class="relative  overflow-visible inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all bg-primary text-primary-foreground 
      hover:bg-primary/90 group hover:scale-110 border-2 border-primary font-semibold px-4 py-2">
        <span class="absolute w-full h-[70%]  bottom-0 -right-1 -z-10 rounded-xl bg-[#ffa51f] opacity-30 blur-md group-hover:opacity-100 transition-opacity duration-300" />
        TICKETS
      </button> -->
      <div  id={currentPath === '/' ? "nav-ticket-button" : ""}
      class={currentPath === '/' ? "opacity-0 pointer-events-none transition-opacity duration-300" : ""}>
        <BubbleButton text="TICKETS" class="rounded-md" textClass="text-3xl mx-1 font-anton font-black tracking-tight uppercase" 
        iconClass="h-8  fill-black group-hover:fill-white -translate-y-[4px] m-0 ml-0" href="/registration"/>
      </div>
    </div>
  </div>
</nav>

<script>
  // Show navigation ticket button when hero ticket button is out of view
  document.addEventListener('DOMContentLoaded', () => {
    const heroButton = document.getElementById('hero-ticket-button');
    const navButton = document.getElementById('nav-ticket-button');
    
    if (!heroButton || !navButton) return;
    
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          // When hero button is NOT intersecting (out of view), show nav button
          if (!entry.isIntersecting) {
            navButton.classList.remove('opacity-0', 'pointer-events-none');
            navButton.classList.add('opacity-100', 'pointer-events-auto');
          } else {
            // When hero button is visible, hide nav button
            navButton.classList.add('opacity-0', 'pointer-events-none');
            navButton.classList.remove('opacity-100', 'pointer-events-auto');
          }
        });
      },
      {
        // Trigger when button is completely out of view
        threshold: 0,
        rootMargin: '0px'
      }
    );
    
    observer.observe(heroButton);
  });
</script>

